{"version":3,"sources":["uni-app:///main.js","webpack:///E:/H盘/F盘/20240102桌面/chong-duomaomao/chong-duomaomao/pages/map.vue?f7d0","webpack:///E:/H盘/F盘/20240102桌面/chong-duomaomao/chong-duomaomao/pages/map.vue?d7af","webpack:///E:/H盘/F盘/20240102桌面/chong-duomaomao/chong-duomaomao/pages/map.vue?325d","webpack:///E:/H盘/F盘/20240102桌面/chong-duomaomao/chong-duomaomao/pages/map.vue?5b73","uni-app:///pages/map.vue","webpack:///E:/H盘/F盘/20240102桌面/chong-duomaomao/chong-duomaomao/pages/map.vue?aab2","webpack:///E:/H盘/F盘/20240102桌面/chong-duomaomao/chong-duomaomao/pages/map.vue?8739"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","markers_fencePanel","res","type","polygons","map","location_my","latitude","longitude","location_info","name","maps","qqmapsdk","geolocation_class","onLoad","console","uni","title","content","showCancel","confirmText","success","that","key","methods","callouttap","createMarkersFencePanel","id","iconPath","width","height","rotate","alpha","zIndex","distance","callout","color","display","borderRadius","padding","reverseGeocoder","location","get_poi","poi_options","fail","complete","click_getLocation","altitude","isHighAccuracy","H5_getLocation","timeout","click_goback","value","t","removeMarker","markers","creatPolygons","mask","fillColor","strokeColor","strokeWidth","newArray","coordinateSort","acc","angle"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,YAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4H;AAC5H;AACuD;AACL;AACsC;;;AAGxF;AACoL;AACpL,gBAAgB,6LAAU;AAC1B,EAAE,yEAAM;AACR,EAAE,0FAAM;AACR,EAAE,mGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,8FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACjBA;AAAA;AAAA;AAAA;AAAwqB,CAAgB,6rBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;ACqC5rB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AAAA,eAOA;EACAC;IACA;MACAC;MACAC;QACAC;MACA;;MACAC;MACAC;MAAA;MACAC;QAAA;QACAC;QACAC;MACA;MACAC;QAAA;QACAC;QACAH;QACAC;MACA;MACAG;MAAA;MACAC;MACAC;IACA;EACA;EACAC;IACA;IACAC;IACA;MAEAC;QACAC;QACAC;QACAC;QACAC;QACAC;UACAC;QACA;MACA;MACA;IACA;IAKA;MACAC;IACA;;IAQA;;IAKA;IACA;MACA;MACA;IACA;MAKA;IAEA;EACA;EACAC;IACAC;MACAV;IACA;IACA;IACAW;MACA;MAEA;QAAA;QACAJ;MACA;MAEA;QACAK;QACApB;QACAC;QACAoB;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QAAA;QACAC;UACAC;UACAlB;UACAmB;UAAA;UACAC;UACAC;QACA;MACA;MACAjB;MACA;QACA;QACAA;MACA;QACA;UACAA;QACA;MACA;IAEA;IACA;IACAkB;MACA;MAEA;QACAjC;QACAC;MACA;MACAc;QACA;QACAmB;QACAC;QACAC;QAEAtB;UAAA;;UAEAC;UACAA,iDACAA;QAGA;QAAAsB;UACA7B;QACA;QACA8B;UACA;QAAA;MAEA;IACA;IACA;IACAC;MACA;MACA9B;QACAb;QACA4C;QAAA;QACAC;QAAA;QACA3B;UAEAC;UACAP;QACA;QACA6B;UACA7B;QACA;MAEA;IACA;IACA;IACAkC;MACA;MACA3B,mCACA;QACAP;QAEAO;QACAA;MACA,GACA;QACAP;MACA,GACA;QAAAmC;MAAA,EACA;IACA;IACAC;MACA;MACA;QACA;MACA;QACA;MACA;MACAnC;QAAAoC;QAAAC;MAAA;MACA/B;IACA;IACA;IACAgC;MACA;MAEA;MACA;QACA;UACAC;QACA;MACA;MACA;AACA;AACA;AACA;MACA;MAGAA;MACA;QACA;UACAA;QACA;MACA;MACA;AACA;AACA;AACA;MACA;MAEA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MAEA;QACA;MACA;MACAxC;QACAC;QACAwC;MACA;MACA;MACA;MACA;MACA;QACAC;QACAC;QACAC;QACA3B;MACA;MACA;QACA;UACA1B;UACAC;QACA;QACAqD;MACA;MACAzD;MACAA;MACAyD;MACA;MAEA;MACA7C;MACAD;IACA;IACA;IACA+C;MACA,gDAGA;QAAA,IAFAvD;UACAC;QAEAuD;QACAA;QACA;MACA;QACAxD;QACAC;MACA;MACA;MACA,yCAGA;QAAA,IAFAD;UACAC;QAEA;UACAD;UACAC;UACAwD;QACA;MACA;MACA;MACA;QAAA;MAAA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC1UA;AAAA;AAAA;AAAA;AAAuyC,CAAgB,owCAAG,EAAC,C;;;;;;;;;;;ACA3zC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/map.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/map.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./map.vue?vue&type=template&id=7592f31a&scoped=true&\"\nvar renderjs\nimport script from \"./map.vue?vue&type=script&lang=js&\"\nexport * from \"./map.vue?vue&type=script&lang=js&\"\nimport style0 from \"./map.vue?vue&type=style&index=0&id=7592f31a&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7592f31a\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/map.vue\"\nexport default component.exports","export * from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./map.vue?vue&type=template&id=7592f31a&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.res.type == 2 && _vm.markers_fencePanel.length > 2\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./map.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./map.vue?vue&type=script&lang=js&\"","<!-- 猫和老鼠创建活动活动范围设置页面 -->\r\n<template>\n\t<view style=\"\n    position: absolute;\n    width: 100%;\n    height: 100%;\n\t\">\n\t\t<map style=\"width: 100%; height: calc(100% - 200px);\"\r\n\t\tref=\"myMap\"\r\n\t\t:markers=\"markers_fencePanel\"\r\n\t\t:polygons=\"polygons\"\r\n\t\t:latitude=\"location_my.latitude\"\r\n\t\t:longitude=\"location_my.longitude\"\r\n\t\t@tap=\"createMarkersFencePanel\"\r\n\t\t@callouttap=\"removeMarker\"\r\n\t\tid=\"map\"\r\n\t\t></map>\r\n\t\t<view style=\"padding: 10px;\" v-if=\"res.type==1\">当前选择位置：</view>\r\n\t\t<view style=\"padding: 10px;color: #7b5206;\" v-show=\"location_info.name\" v-if=\"res.type==1\">{{location_info.name}}</view>\r\n\t\t\r\n\t\t<view style=\"padding: 10px;font-size: 16px;color: #4a4a4a;\" v-if=\"res.type==2\">【活动围栏设置提示】</view>\r\n\t\t<view style=\"padding: 10px;font-size: 16px;color: #4a4a4a;\" v-if=\"res.type==2\">\r\n\t\t\t1、调整地图大小，可获取较大范围活动地区；<br>\r\n\t\t\t2、在地图中进行“点击”，至少三个点位；<br>\r\n\t\t\t3、设置的围栏可限制活动范围，如参与者离开活动范围5分钟将会自动淘汰；\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"but-box\" v-if=\"res.type==1\">\r\n\t\t\t<view class=\"b-box\" @click=\"click_goback\">选择地址</view>\r\n\t\t</view>\r\n\t\t<view class=\"but-box\" v-if=\"res.type==2 && markers_fencePanel.length>2\">\r\n\t\t\t<view class=\"b-box\" @click=\"click_goback\">确定</view>\r\n\t\t</view>\n\t</view>\n</template>\n\n<script>\r\n\timport QQMapWX from \"@/static/js/qqmap-wx-jssdk.min.js\";\r\n\t// 实例化API核心类\n\n\r\n\t// #ifdef H5\r\n\t\timport geolocation from \"@/static/js/geolocation.min.js\";\r\n\t// #endif \r\n\t\n\texport default {\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tmarkers_fencePanel:[],\r\n\t\t\t\tres:{\r\n\t\t\t\t\ttype:1,//1=等于选择位置，2=选择区域\r\n\t\t\t\t},\r\n\t\t\t\tpolygons:[],\r\n\t\t\t\tmap:null,//上一个页面传递过来的\n\t\t\t\tlocation_my:{//我的位置\r\n\t\t\t\t\tlatitude:0,\r\n\t\t\t\t\tlongitude:0,\r\n\t\t\t\t},\r\n\t\t\t\tlocation_info:{//逆解析的存储\r\n\t\t\t\t\tname:'',\r\n\t\t\t\t\tlatitude:0,\r\n\t\t\t\t\tlongitude:0,\r\n\t\t\t\t},\r\n\t\t\t\tmaps:null,//地图实例方法\r\n\t\t\t\tqqmapsdk:null,\r\n\t\t\t\tgeolocation_class:null,\n\t\t\t}\n\t\t},\r\n\t\tonLoad(e) {\r\n\t\t\tvar that = this\r\n\t\t\tconsole.log(e)\r\n\t\t\tif(!e.t || !e.map){\r\n\t\t\t\t\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle:'提示',\r\n\t\t\t\t\tcontent:'获取地图KEY失败',\r\n\t\t\t\t\tshowCancel:false,\r\n\t\t\t\t\tconfirmText:'知道啦',\r\n\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\tthat.$common.goback()\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t//#ifdef MP-WEIXIN\r\n\t\t\t\tthis.qqmapsdk = new QQMapWX({\r\n\t\t\t\t\tkey: e.map // 必填\r\n\t\t\t});\r\n\t\t\t// #endif\r\n\t\t\t\r\n\t\t\t// #ifdef H5\r\n\t\t\t\t// 实例化API核心类\r\n\t\t\t\tthis.geolocation_class = new Geolocation(e.map, \"myapp\");\r\n\t\t\t// #endif \r\n\t\t\t\r\n\t\t\tthis.res.type = e.t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t// 查看是否已经选择活动地点,如果已经选择则在这个地图中心移动到这个坐标上\r\n\t\t\tif(e.latitude!='' && e.longitude!=''){\r\n\t\t\t\tthis.location_my.latitude = Number(e.latitude)\r\n\t\t\t\tthis.location_my.longitude = Number(e.longitude)\r\n\t\t\t}else{\r\n\t\t\t\t// #ifdef H5\r\n\t\t\t\t\tthis.H5_getLocation()\r\n\t\t\t\t// #endif \r\n\t\t\t\t// #ifdef MP-WEIXIN\r\n\t\t\t\t\tthis.click_getLocation()\r\n\t\t\t\t// #endif\r\n\t\t\t}\r\n\t\t},\n\t\tmethods: {\r\n\t\t\tcallouttap(e){\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t},\r\n\t\t\t// 创建围栏标记点\r\n\t\t\tcreateMarkersFencePanel(e) {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\t\r\n\t\t\t\tif(that.res.type == 1){//如果是选择地点的话就只能存在一个\r\n\t\t\t\t\tthat.markers_fencePanel = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet markerItem = {\r\n\t\t\t\t\tid: that.markers_fencePanel.length,\r\n\t\t\t\t\tlatitude: e.detail.latitude,\r\n\t\t\t\t\tlongitude: e.detail.longitude,\r\n\t\t\t\t\ticonPath: '/static/img/dingwei.png',\r\n\t\t\t\t\twidth: '50px',\r\n\t\t\t\t\theight: '50px',\r\n\t\t\t\t\trotate: 0,\r\n\t\t\t\t\talpha: 1,\r\n\t\t\t\t\tzIndex: 4,\r\n\t\t\t\t\tdistance: 0,//距离自己多少米\r\n\t\t\t\t\tcallout:{\r\n\t\t\t\t\t\tcolor:'#01bb75',\r\n\t\t\t\t\t\tcontent: '删除',\r\n\t\t\t\t\t\tdisplay: that.res.type == 1 ?'BYCLICK' : 'ALWAYS',//'BYCLICK':点击显示; 'ALWAYS':常显\r\n\t\t\t\t\t\tborderRadius:50,\r\n\t\t\t\t\t\tpadding:10,\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tthat.markers_fencePanel.push(markerItem)//加入公共坐标数组\r\n\t\t\t\tif(that.res.type == 1){\r\n\t\t\t\t\t//逆解析地址\r\n\t\t\t\t\tthat.reverseGeocoder(e);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tif (that.markers_fencePanel.length > 2) {\r\n\t\t\t\t\t\tthat.creatPolygons()\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t//逆解析地址\r\n\t\t\treverseGeocoder(e){\r\n\t\t\t\tvar that = this;\r\n\t\t\t\t\r\n\t\t\t\tlet location =  {\r\n\t\t\t\t\t latitude:e.detail.latitude,\r\n\t\t\t\t\t longitude: e.detail.longitude\r\n\t\t\t   }\r\n\t\t\t\tthat.qqmapsdk.reverseGeocoder({\r\n\t\t\t\t  //Object格式\r\n\t\t\t\t\t   location:location, \r\n\t\t\t\t\t   get_poi:1,\r\n\t\t\t\t\t   poi_options:'address_format=short;radius=1000;policy=2',\r\n\t\t\t\t\t   \r\n\t\t\t\t\tsuccess: function(res) {//成功后的回调\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tthat.location_info.name = res.result.formatted_addresses.recommend;\r\n\t\t\t\t\t\tthat.location_info.latitude = location.latitude,\r\n\t\t\t\t\t\tthat.location_info.longitude = location.longitude\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t   },fail: function(error) {\r\n\t\t\t\t\t   console.error(error);\r\n\t\t\t\t\t },\r\n\t\t\t\t\t complete: function(res) {\r\n\t\t\t\t\t   //console.log(res);\r\n\t\t\t\t\t }\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//定位自己的坐标点\r\n\t\t\tclick_getLocation(){\r\n\t\t\t\tvar that = this\r\n\t\t\t\tuni.getLocation({\r\n\t\t\t\t\ttype:'gcj02',\r\n\t\t\t\t\taltitude:true,//传入 true 会返回高度信息，由于获取高度需要较高精确度，会减慢接口返回速度\r\n\t\t\t\t\tisHighAccuracy:true,//开启高精度定位\r\n\t\t\t\t\tsuccess:function(res){\r\n\t\t\t\t\t\r\n\t\t\t\t\t\tthat.location_my = res\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail:function(res){\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t},\t\t\t\r\n\t\t\t//H5-定位自己的坐标点\r\n\t\t\tH5_getLocation(){\r\n\t\t\t\tvar that = this\r\n\t\t\t\tthat.geolocation_class.getLocation(\r\n\t\t\t\t(e)=>{\r\n\t\t\t\t\tconsole.log(\"geolocation_class_1\",e)\r\n\t\t\t\t\t\r\n\t\t\t\t\tthat.location_my.latitude = e.lat\r\n\t\t\t\t\tthat.location_my.longitude = e.lng\r\n\t\t\t\t}, \r\n\t\t\t\t(e)=>{\r\n\t\t\t\t\tconsole.log(\"geolocation_class_2\",e)\r\n\t\t\t\t}, \r\n\t\t\t\t{timeout: 8000},\r\n\t\t\t\t)\r\n\t\t\t},\r\n\t\t\tclick_goback(){\r\n\t\t\t\tvar that = this\r\n\t\t\t\tif(that.res.type==1){\r\n\t\t\t\t\tvar tmp = that.location_info\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar tmp = that.polygons[0].points\r\n\t\t\t\t}\r\n\t\t\t\tuni.$emit('creation',{value:tmp,t:that.res.type})\r\n\t\t\t\tthat.$common.goback()\r\n\t\t\t},\r\n\t\t\t// 删除重复点击的标记点\r\n\t\t\tremoveMarker(e) {\r\n\t\t\t\tlet id = e.markerId\r\n\t\t\t\t\r\n\t\t\t\tlet markers = JSON.parse(JSON.stringify(this.markers_fencePanel))\r\n\t\t\t\tfor (let i in markers) {\r\n\t\t\t\t\tif (markers[i].id == id) {\r\n\t\t\t\t\t\tmarkers.splice(i, 1)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t/* // 重置marker数组的id\r\n\t\t\t\tfor (let j = 0; j < markers.length; j++) {\r\n\t\t\t\t\tmarkers[j].id = j;\r\n\t\t\t\t} */\r\n\t\t\t\tthis.markers_fencePanel = markers\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\t markers = JSON.parse(JSON.stringify(this.markers_fencePanel))\r\n\t\t\t\t\tfor (let i in markers) {\r\n\t\t\t\t\t\tif (markers[i].id == id) {\r\n\t\t\t\t\t\t\tmarkers.splice(i, 1)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/* // 重置marker数组的id\r\n\t\t\t\t\tfor (let j = 0; j < markers.length; j++) {\r\n\t\t\t\t\t\tmarkers[j].id = j;\r\n\t\t\t\t\t} */\r\n\t\t\t\t\tthis.markers = markers\r\n\t\t\t\t\r\n\t\t\t\tif (this.markers_fencePanel.length <= 2) {\r\n\t\t\t\t\tthis.polygons = []\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.creatPolygons()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 绘制多边形围栏\r\n\t\t\tcreatPolygons() {\r\n\t\t\t\r\n\t\t\t\t\tif (this.markers_fencePanel.length < 3) {\r\n\t\t\t\t\t\treturn false\r\n\t\t\t\t\t}\r\n\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\ttitle:'绘制中',\r\n\t\t\t\t\t\tmask:true\r\n\t\t\t\t\t})\r\n\t\t\t\t\tlet polygons = this.polygons;\r\n\t\t\t\t\tlet markers_tmp = this.coordinateSort(this.markers_fencePanel)\r\n\t\t\t\t\tlet newArray = [];\r\n\t\t\t\t\tlet params = {\r\n\t\t\t\t\t\tfillColor: \"#3336fc2b\",\r\n\t\t\t\t\t\tstrokeColor: \"#ff383b\",\r\n\t\t\t\t\t\tstrokeWidth: 2,\r\n\t\t\t\t\t\tzIndex: 3\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfor (let j = 0; j < markers_tmp.length; j++) {\r\n\t\t\t\t\t\tlet obj = {\r\n\t\t\t\t\t\t\tlatitude: markers_tmp[j].latitude,\r\n\t\t\t\t\t\t\tlongitude: markers_tmp[j].longitude\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tnewArray.push(obj);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpolygons[0] = {};\r\n\t\t\t\t\tpolygons[0].points = newArray;\r\n\t\t\t\t\tnewArray = Object.assign(polygons[0], params);\r\n\t\t\t\t\tthis.polygons[0] = newArray\r\n\t\t\t\t\t\r\n\t\t\t\t\tthis.$emit(\"getPointsArr\", newArray)\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\tconsole.log(JSON.stringify(newArray))\r\n\t\t\t},\r\n\t\t\t// 使用reduce获取中心（平均值）\r\n\t\t\tcoordinateSort(points) {\r\n\t\t\t\tconst center = points.reduce((acc, {\r\n\t\t\t\t\tlatitude,\r\n\t\t\t\t\tlongitude\r\n\t\t\t\t}) => {\r\n\t\t\t\t\tacc.latitude += latitude / points.length;\r\n\t\t\t\t\tacc.longitude += longitude / points.length;\r\n\t\t\t\t\treturn acc;\r\n\t\t\t\t}, {\r\n\t\t\t\t\tlatitude: 0,\r\n\t\t\t\t\tlongitude: 0\r\n\t\t\t\t});\r\n\t\t\t\t// 使用tan（angle）=y/x将角度特性添加到每个点\r\n\t\t\t\tconst angles = points.map(({\r\n\t\t\t\t\tlatitude,\r\n\t\t\t\t\tlongitude\r\n\t\t\t\t}) => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tlatitude,\r\n\t\t\t\t\t\tlongitude,\r\n\t\t\t\t\t\tangle: Math.atan2(longitude - center.longitude, latitude - center.latitude) * 180 / Math.PI\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t\t// 按角度排序\r\n\t\t\t\tconst pointsSorted = angles.sort((a, b) => a.angle - b.angle);\r\n\t\t\t\treturn pointsSorted\r\n\t\t\t}\n\t\t}\n\t}\n</script>\n\n<style lang=\"scss\" scoped>\n\r\n.but-box{\r\n\tposition: fixed;\n    width: 100%;\n    left: 0px;\n    background-color: #fff;\n    bottom: 20rpx;\n    height: 160rpx;\n    border-top-left-radius: 20rpx;\n    border-top-right-radius: 20rpx;\n    display: flex;\n    justify-content: center;\n    flex-direction: column;\r\n\tz-index: 10;\r\n}\r\n.b-box{\r\n\tflex-shrink: 0;\r\n\theight: 60rpx;\r\n\tline-height: 2rpx;\r\n\tfont-size: 28rpx;\r\n\tcolor: #fff;\r\n\tbackground: #0186ff;\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tjustify-content: center;\r\n\tpadding: 10rpx;\r\n\tborder-radius: 14rpx;\r\n\ttext-align: center;\r\n\twidth: 85%;\r\n\tmargin: auto;\r\n}\n</style>\n","import mod from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./map.vue?vue&type=style&index=0&id=7592f31a&lang=scss&scoped=true&\"; export default mod; export * from \"-!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!C:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./map.vue?vue&type=style&index=0&id=7592f31a&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1739012691372\n      var cssReload = require(\"C:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}